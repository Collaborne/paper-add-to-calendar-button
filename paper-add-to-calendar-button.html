<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-menu-button/paper-menu-button.html">
<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="add-to-calendar-mixin.html">

<dom-module id="paper-add-to-calendar-button">
	<template>
		<style>
			:host {
				display: inline-block;
			}
			paper-menu-button {
				--paper-menu-button-content: {
					border-radius: 5px;
				}
			}
			paper-button {
				@apply --paper-add-to-calendar-button-button;
			}
			iron-icon {
				margin-right: 8px;
			}
			.actions {
				padding: 8px 0;
				text-align: left;
				min-width: 120px;
			}
			.actions iron-icon {
				@apply --paper-add-to-calendar-button-cal-icon;
			}
			.action {
				display: block;
				padding: 8px 16px;
				cursor: pointer;
				color: initial;
				text-decoration: none;
				@apply --paper-add-to-calendar-button-action;
			}
			.action:hover {
				background: var(--paper-add-to-calendar-button-action-hover-background-color, lightgray);
			}
		</style>
		<paper-menu-button id="menu" horizontal-offset="8" vertical-offset="40">
			<paper-button slot="dropdown-trigger">
				<iron-icon icon="icons:file-download"></iron-icon>
				[[actionText]]
			</paper-button>
			<div class="actions" slot="dropdown-content">
				<a
					class="action"
					href="[[computeGoogle(title, start, end, duration, description, location)]]"
					on-tap="_closeMenu"
					target="_blank"
				><iron-icon icon="calendar:google"></iron-icon> Google</a>
				<a
					class="action"
					href="[[computeYahoo(title, start, end, duration, description, location)]]"
					on-tap="_closeMenu"
					target="_blank"
				><iron-icon icon="calendar:yahoo"></iron-icon> Yahoo</a>
				<a
					class="action"
					href="[[computeIcs(title, start, end, duration, description, location)]]"
					on-tap="_closeMenu"
				><iron-icon icon="calendar:apple"></iron-icon> iCal</a>
				<a
					class="action"
					href="[[computeIcs(title, start, end, duration, description, location)]]"
					on-tap="_closeMenu"
				><iron-icon icon="calendar:outlook"></iron-icon> Outlook</a>
			</div>
		</paper-menu-button>
	</template>

	<script>
		/**
		 * `paper-add-to-calendar-button`
		 * Polymer button that allows downloading an event into various calendars
		 *
		 * @customElement
		 * @polymer
		 * @demo demo/index.html
		 */
		class PaperAddToCalendarButton extends Polymer.AddToCalendarMixin(Polymer.Element) {
			static get is() {
				return 'paper-add-to-calendar-button';
			}

			static get properties() {
				return {
					title: String,
					start: Date,
					end: Date,
					duration: Number,
					description: String,
					location: String,

					actionText: {
						type: String,
						value: 'Add to calendar',
					},
				};
			}

			_closeMenu() {
				this.$.menu.close();
			}
		}

		window.customElements.define(PaperAddToCalendarButton.is, PaperAddToCalendarButton);
	</script>
</dom-module>
